define(["require","exports","tslib","react","external/react-dom","external/lodash","modules/clean/react/previews/pdf_viewer/progress_bar","modules/clean/react/previews/pdf_viewer/utils","modules/core/exception","modules/core/i18n"],function(e,t,a,n,o,r,d,i,s,m){"use strict";function u(e,t){var a=window.open("about:blank");if(!a)throw new Error(m._("Could not open new window"));var d=r.maxBy(e.dimensions,function(e){return e[2]}),i=d[0]/72,s=d[1]/72;window.setTimeout(function(){var r=a.document.createElement("style");r.innerHTML="\n      @page { margin: 0; size: "+i+"in "+s+"in; }\n      img { width: 100%; }\n      .print-progress { height: 8px; background-color: #0070E0; float: left; }\n    ",a.document.head.appendChild(r);var d=a.document.createElement("div");a.document.body.appendChild(d);var m=function(){a.print()};o.render(n.default.createElement(p,{metadata:e,document:a.document,onLoad:m,urls:t}),d)},50)}Object.defineProperty(t,"__esModule",{value:!0}),n=a.__importDefault(n),o=a.__importStar(o),r=a.__importStar(r);var p=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.imagesLoaded={},t.state={numImagesLoaded:0},t.onImageResolve=function(e){return function(){t.state.numImagesLoaded<t.props.metadata.page_count&&!t.imagesLoaded[e]&&(t.imagesLoaded[e]=!0,t.setState(function(e,t){return{numImagesLoaded:e.numImagesLoaded+1}}))}},t}return a.__extends(t,e),t.prototype.printIfReady=function(){if(s.assert(this.state.numImagesLoaded<=this.props.metadata.page_count,"not all images loaded"),this.state.numImagesLoaded===this.props.metadata.page_count&&this.props.onLoad)return void this.props.onLoad()},t.prototype.componentDidMount=function(){for(var e=0,t=this.props.document.getElementsByTagName("img"),a=0;a<t.length;a++)t[a].complete&&e++;this.setState({numImagesLoaded:e})},t.prototype.componentDidUpdate=function(e,t){this.printIfReady()},t.prototype.render=function(){var e=this,t={pageBreakInside:"avoid",pageBreakAfter:"always"};return n.default.createElement("div",null,n.default.createElement(d.ProgressBar,{totalImages:this.props.metadata.page_count,numImagesLoaded:this.state.numImagesLoaded}),i.mapPages(this.props.metadata.dimensions,function(a,o,r){return n.default.createElement("img",{key:a,src:e.props.urls.imageUrl(a),style:t,onLoad:e.onImageResolve(a),onError:e.onImageResolve(a),alt:""+(a+1)})}))},t})(n.default.Component);t.Printable=p,t.print=u});
//# sourceMappingURL=printable.min.js-vflViSs4g.map