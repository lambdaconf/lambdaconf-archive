define("modules/clean/abuse/recaptcha_helper",["require","exports","tslib","modules/constants/login_and_register","modules/constants/page_load","modules/clean/global_constants","modules/clean/web_timing_logger","modules/core/exception","modules/core/uri"],function(e,t,a,r,n,c,i,o,s){"use strict";function u(){return null!=t.captchaPromise}function h(){t.captchaPromise=null}function l(e,a){return void 0!==a&&(d=a),t.captchaPromise||(t.captchaPromise=e?new Promise(function(e,t){i.waitForTTI().then(e),setTimeout(e,2500)}).then(_):_()),t.captchaPromise}function p(){var e=n.USER_LOCALE.replace("_","-"),t={onload:"recaptchaOnloadCallback",render:"explicit",hl:e};return new s.URI({scheme:"https",authority:"www.google.com",path:"/recaptcha/api.js",query:t}).toString()}function _(){return new Promise(function(n,i){if(window.recaptchaOnloadCallback=function(){n(window.grecaptcha)},r.SHOULD_LOAD_FUNCAPTCHA&&d&&new Promise(function(t,a){e(["modules/clean/abuse/funcaptcha_modal"],t,a)}).then(a.__importStar).then(function(e){(0,e.loadFuncaptchaModal)()}),t.isTest())n(y);else{var s=document.createElement("script"),u=p();if(s.setAttribute("src",u),!c.GlobalConstants.CSP_SCRIPT_NONCE)return o.reportException({err:new Error("CSP nonce not set"),severity:o.SEVERITY.CRITICAL,tags:["product-safety-infra","recaptcha"]}),void i();s.setAttribute("nonce",c.GlobalConstants.CSP_SCRIPT_NONCE),document.body.appendChild(s)}})}Object.defineProperty(t,"__esModule",{value:!0}),r=a.__importStar(r),o=a.__importStar(o);var d=!1;t.HasCaptchaLoaded=u,t.ClearCaptchaPromise=h,t.LoadRecaptcha=l,t.isTest=function(){return r.IS_SELENIUM_TEST},t.BuildRecaptchaURI=p;var m={},f={},v=0;t.DUMMY_RESPONSE="DUMMY-RESPONSE";var b=function(e){e.setAttribute("class","g-recaptcha-response"),e.setAttribute("name","g-recaptcha-response"),e.value=""},y={reset:function(e){return b(f[e].querySelector(".g-recaptcha-response")),!0},render:function(e,a,r){var n=v;v+=1,o.assert(null==e.querySelector(".g-recaptcha-response"),"can't render multiple recaptcha elements in same div");var c=document.createElement("textarea");return c.id="g-recaptcha-response-"+n,b(c),e.appendChild(c),f[n]=e,m[n]=function(){var e=t.DUMMY_RESPONSE;return c.value=e,a.callback&&a.callback(e),e},n},execute:function(e){return Promise.resolve(m[e]())}}}),define("modules/clean/captcha",["require","exports","tslib","external/react-dom","jquery","modules/clean/abuse/recaptcha_helper","modules/clean/ajax","modules/core/i18n","modules/core/notify"],function(e,t,a,r,n,c,i,o,s){"use strict";function u(e,t){return void 0!==e&&null!==e?t(e):void 0}Object.defineProperty(t,"__esModule",{value:!0}),r=a.__importStar(r),n=a.__importDefault(n),i=a.__importStar(i);var h=(function(){function e(e,t,a,r,n,c,i){this._show_captcha_v2=this._show_captcha_v2.bind(this),this._hide_captcha_v2=this._hide_captcha_v2.bind(this),this._hide_other_captcha=this._hide_other_captcha.bind(this),this.captcha_display_handler=this.captcha_display_handler.bind(this),this.parent_form=e,this.captcha_div=t,this.other_recaptcha_div=a,this.endpoint=r,this.email_name=n,this.variant=c,this.is_v2=i,this.$recaptcha_container=u(this.parent_form.find(this.captcha_div),function(e){return e[0]}),this.$recaptcha_react_component=null}return e.prototype._show_captcha_v2=function(e,t){var a=this;n.default("#"+this.captcha_div).parent().show(),c.LoadRecaptcha().then(function(t){n.default("#"+a.captcha_div).children().length?t.reset():t.render(a.captcha_div,{sitekey:e})})},e.prototype._hide_captcha_v2=function(){return n.default("#"+this.captcha_div).parent().hide()},e.prototype._hide_other_captcha=function(){var e=n.default(this.other_recaptcha_div)[0];if(null!=(null!=e?e.children:void 0))return r.unmountComponentAtNode(e)},e.prototype.captcha_display_handler=function(e){var t=this;return i.WebRequest({url:this.endpoint,data:{email:this.parent_form.find("input[name='"+this.email_name+"']").val()},success:function(a){try{var r=JSON.parse(a);return r.needs_captcha?(t._hide_other_captcha(),t._show_captcha_v2(r.recaptcha_v2_public_key,e)):t._hide_captcha_v2()}catch(e){return s.Notify.error(o._("There was a problem completing this request."))}}})},e})();t.default=h}),define("modules/clean/global_constants",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GlobalConstants=window.GlobalConstants}),define("modules/clean/react/payments/common/adapters/captcha",["require","exports","modules/clean/ajax_as_promised","modules/core/i18n","modules/core/notify"],function(e,t,a,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(){function e(){}return e.getRecaptchaChallenge=function(){var e=document.getElementById("recaptcha_challenge_field");return e&&e.value},e.requestCaptcha=function(e){return a.WebRequest({url:"/ajax_needs_business_signup_captcha",data:{email:e}}).then(function(e){try{var t=JSON.parse(e);return{needsCaptcha:t.needs_captcha,recaptchaPublicKey:t.recaptcha_public_key}}catch(e){throw n.Notify.error(r._("There was a problem completing this request.")),e}},function(e){var t=e.jqXHR;return Promise.reject(t.statusText)})},e})();t.Captcha=c});
//# sourceMappingURL=pkg-captcha.min.js-vflZjXdhu.map