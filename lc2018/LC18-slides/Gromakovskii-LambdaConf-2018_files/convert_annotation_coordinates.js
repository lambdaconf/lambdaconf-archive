define(["require","exports","tslib","external/lodash","modules/clean/annotations/annotation","modules/clean/react/previews/pdf_viewer/utils","modules/clean/comments/constants"],function(t,e,n,o,i,r,a){"use strict";function s(t){switch(t){case a.AnnotationTypes.HIGHLIGHT:return"highlight";case a.AnnotationTypes.REGION:return"rectangle";case a.AnnotationTypes.MARKER:return"other";default:throw new Error("Unknown annotation type: "+t)}}function p(t){var e=t.pdf_coordinates||t.image_coordinates;if(!e)throw new Error("annotation must be for a pdf/image");var n=e.map(function(t){var e=t.page,n=t.coordinates,i=t.page_size,r=i.width,a=i.height,s=n.map(function(t){return a-t.y}),p=o.map(n,"x"),u=o.min(p)||0,c=o.min(s)||0;return{page:e,x:u/r,y:c/a,width:((o.max(p)||0)-u)/r,height:((o.max(s)||0)-c)/a}});return t.pdf_coordinates?{type:"document",regionType:s(t.type),regions:n}:{type:"image",region:n[0]}}function u(t){switch(t){case"highlight":return{type:a.AnnotationTypes.HIGHLIGHT,subtype:a.AnnotationSubtypes.HIGHLIGHT.HIGHLIGHT};case"rectangle":return{type:a.AnnotationTypes.REGION,subtype:a.AnnotationSubtypes.REGION.RECTANGLE};default:throw new Error("Unknow annotation type: "+t)}}function c(t,e,n,i){return o.range(4).map(function(o){return{x:e+(o%3?n:0),y:t-(o>1?i:0)}})}function h(t,e){function n(t){var e=g[t.page-1],n=e[0],o=e[1],i=n*t.width,r=o*t.height,s=o*(1-t.y),u=n*t.x,h=c(s,u,i,r);return p===a.AnnotationTypes.HIGHLIGHT&&(h=h.filter(function(t,e){return e%2===0})),{page:t.page,coordinates:h,page_size:{width:n,height:o}}}var o="document"===t.type?t.regionType:"rectangle",s=u(o),p=s.type,h=s.subtype,m=new i.Annotation(p,h),g=r.expandDimensions(e.dimensions);switch(t.type){case"document":m.pdf_coordinates=t.regions.map(n);break;case"image":m.image_coordinates=[n(t.region)]}return m}function m(t,e){for(var n="document"===t.type?t.regions:[t.region],o=n.map(function(t){var n=t.height*e.height,o=t.width*e.width,i=e.top+t.y*e.height,r=e.left+t.x*e.width;return{top:i,left:r,bottom:i+n,right:r+o}}),i=1/0,r=1/0,a=-(1/0),s=-(1/0),p=0,u=o;p<u.length;p++){var c=u[p],h=c.top,m=c.left,g=c.right,d=c.bottom;i=Math.min(h,i),r=Math.min(m,r),a=Math.max(d,a),s=Math.max(g,s)}return{top:i,left:r,right:s,bottom:a,height:a-i,width:s-r}}Object.defineProperty(e,"__esModule",{value:!0}),o=n.__importStar(o),e.fromFileViewToComments2Annotation=p,e.fromComments2ToFileViewAnnotations=h,e.convertFromComments2ToClientRect=m});
//# sourceMappingURL=convert_annotation_coordinates.min.js-vfl86CBdL.map