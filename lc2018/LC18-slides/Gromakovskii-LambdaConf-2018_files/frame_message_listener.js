define(["require","exports","modules/clean/react/file_viewer/file_viewer_interface_controller","modules/clean/react/file_viewer/constants","modules/clean/react/comments2/data/actions","modules/clean/react/comments2/convert_annotation_coordinates","modules/clean/react/comments2/data/sidebar_watcher"],function(n,t,e,i,o,a,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(){function n(n){var t=this;this.dispatch=n,this.onAnnotationPlaced=function(n){t.updatePendingAnnotation(n.annotation)},this.onAnnotationHidden=function(){t.dispatch(o.Actions.clearPendingDocOrImageAnnotation())},this.onAnnotationStartDrag=function(n){},this.onAnnotationEndDrag=function(n){t.updatePendingAnnotation(n.annotation)},this.onAnnotationEnter=function(n){var e=n.commentActivity,i=e&&e.activity_key;t.dispatch(o.Actions.hoverThread(i))},this.onAnnotationLeave=function(n){t.dispatch(o.Actions.hoverThread(void 0))},this.onCommentsVisible=function(){t.dispatch(o.Actions.trackSidebarCommentsVisibility(!0))},this.onCommentsHidden=function(){t.dispatch(o.Actions.trackSidebarCommentsVisibility(!1))},this.docMetadataLoad=function(n){var e=n.metadata;t.dispatch(o.Actions.docMetadataLoad(e))},this.eventListenerMap={"annotation-placed":this.onAnnotationPlaced,"annotation-start-drag":this.onAnnotationStartDrag,"annotation-end-drag":this.onAnnotationEndDrag,"annotation-hidden":this.onAnnotationHidden,"annotation-ui-enter":this.onAnnotationEnter,"annotation-ui-leave":this.onAnnotationLeave,"doc-metadata-load":this.docMetadataLoad},this.sideChannelListenerMap=(a={},a[r.COMMENTS_VISIBLE_SIGNAL]=this.onCommentsVisible,a[r.COMMENTS_HIDDEN_SIGNAL]=this.onCommentsHidden,a),this.interfaceController=new e.FileViewerInterfaceController(i.FileViewerInterfaceType.Frame);var a}return n.prototype.handleMount=function(){for(var n in this.eventListenerMap)this.interfaceController.addListener(n,this.eventListenerMap[n]);for(var n in this.sideChannelListenerMap)r.sideChannelEventEmitter.addListener(n,this.sideChannelListenerMap[n]);this.interfaceController.dispatchEvent("enable-annotation-creation"),this.interfaceController.dispatchEvent("enable-region-creation"),this.interfaceController.dispatchEvent("request-doc-metadata")},n.prototype.handleUnmount=function(){for(var n in this.eventListenerMap)this.interfaceController.removeListener(n,this.eventListenerMap[n]);for(var n in this.sideChannelListenerMap)r.sideChannelEventEmitter.removeListener(n,this.sideChannelListenerMap[n]);this.interfaceController.dispatchEvent("disable-annotation-creation"),this.interfaceController.dispatchEvent("disable-region-creation")},n.prototype.syncAnnotations=function(n,t){var e=n.map(function(n){var e=n.annotation,i=void 0!==e.label?e.label:-1;return{annotation:a.fromComments2ToFileViewAnnotations(e,t),commentActivity:{activity_key:n.id},options:{isGhostAnnotation:!1,isAnnotationNumberingEnabled:i!==-1,annotationNumber:i}}});this.interfaceController.dispatchEvent("update-annotations",{annotations:e})},n.prototype.placeDefaultAnnotation=function(){this.interfaceController.dispatchEvent("place-default-annotation")},n.prototype.scrollToAnnotation=function(n,t){this.interfaceController.dispatchEvent("scroll-to-annotation",{page:n,commentActivity:{activity_key:t}})},n.prototype.clearSelection=function(){this.interfaceController.dispatchEvent("clear-annotation-selection",{annotations:[]})},n.prototype.updatePendingAnnotation=function(n){var t=a.fromFileViewToComments2Annotation(n),e="document"===t.type?o.Actions.setPendingDocumentAnnotation(t):o.Actions.setPendingImageAnnotation(t);this.dispatch(e)},n})();t.FrameMessageListener=s});
//# sourceMappingURL=frame_message_listener.min.js-vfl1Z_idL.map